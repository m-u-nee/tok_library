2024-09-27 14:47:55.388 | INFO     | datatrove.utils.logging:add_task_logger:58 - Launching pipeline for rank=0
2024-09-27 14:47:55.388 | INFO     | datatrove.utils.logging:log_pipeline:90 - 
--- ğŸ› ï¸ PIPELINE ğŸ› 
ğŸ“– - READER: ğŸ“’ Parquet
ğŸ”¢ - TOKENIZER: âœï¸ Writer
2024-09-27 14:47:55.388 | INFO     | datatrove.pipeline.tokens.tokenizer:run:389 - Tokenizing in "00000_unshuffled.ds"...
2024-09-27 14:47:55.432 | ERROR    | datatrove.executor.base:_run_for_rank:108 - No files found on /Users/mattia/Desktop/pleias/tok_library/data/ItalianPD_1.parquet!
Traceback (most recent call last):

  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/Users/mattia/miniconda3/envs/general_ml/lib/python3.11/unittest/__main__.py", line 18, in <module>
    main(module=None)
    â”” <class 'unittest.main.TestProgram'>
  File "/Users/mattia/miniconda3/envs/general_ml/lib/python3.11/unittest/main.py", line 102, in __init__
    self.runTests()
    â”‚    â”” <function TestProgram.runTests at 0x102b6eac0>
    â”” <unittest.main.TestProgram object at 0x1026ce590>
  File "/Users/mattia/miniconda3/envs/general_ml/lib/python3.11/unittest/main.py", line 274, in runTests
    self.result = testRunner.run(self.test)
    â”‚             â”‚          â”‚   â”‚    â”” <unittest.suite.TestSuite tests=[<unittest.suite.TestSuite tests=[<unittest.suite.TestSuite tests=[<tests.test_tokenization_r...
    â”‚             â”‚          â”‚   â”” <unittest.main.TestProgram object at 0x1026ce590>
    â”‚             â”‚          â”” <function TextTestRunner.run at 0x102b6e3e0>
    â”‚             â”” <unittest.runner.TextTestRunner object at 0x13d0eb5d0>
    â”” <unittest.main.TestProgram object at 0x1026ce590>
  File "/Users/mattia/miniconda3/envs/general_ml/lib/python3.11/unittest/runner.py", line 217, in run
    test(result)
    â”‚    â”” <unittest.runner.TextTestResult run=1 errors=0 failures=0>
    â”” <unittest.suite.TestSuite tests=[<unittest.suite.TestSuite tests=[<unittest.suite.TestSuite tests=[<tests.test_tokenization_r...
  File "/Users/mattia/miniconda3/envs/general_ml/lib/python3.11/unittest/suite.py", line 84, in __call__
    return self.run(*args, **kwds)
           â”‚    â”‚    â”‚       â”” {}
           â”‚    â”‚    â”” (<unittest.runner.TextTestResult run=1 errors=0 failures=0>,)
           â”‚    â”” <function TestSuite.run at 0x102b12ac0>
           â”” <unittest.suite.TestSuite tests=[<unittest.suite.TestSuite tests=[<unittest.suite.TestSuite tests=[<tests.test_tokenization_r...
  File "/Users/mattia/miniconda3/envs/general_ml/lib/python3.11/unittest/suite.py", line 122, in run
    test(result)
    â”‚    â”” <unittest.runner.TextTestResult run=1 errors=0 failures=0>
    â”” <unittest.suite.TestSuite tests=[<unittest.suite.TestSuite tests=[<tests.test_tokenization_round_trip.TestTokenizationRoundTr...
  File "/Users/mattia/miniconda3/envs/general_ml/lib/python3.11/unittest/suite.py", line 84, in __call__
    return self.run(*args, **kwds)
           â”‚    â”‚    â”‚       â”” {}
           â”‚    â”‚    â”” (<unittest.runner.TextTestResult run=1 errors=0 failures=0>,)
           â”‚    â”” <function TestSuite.run at 0x102b12ac0>
           â”” <unittest.suite.TestSuite tests=[<unittest.suite.TestSuite tests=[<tests.test_tokenization_round_trip.TestTokenizationRoundTr...
  File "/Users/mattia/miniconda3/envs/general_ml/lib/python3.11/unittest/suite.py", line 122, in run
    test(result)
    â”‚    â”” <unittest.runner.TextTestResult run=1 errors=0 failures=0>
    â”” <unittest.suite.TestSuite tests=[<tests.test_tokenization_round_trip.TestTokenizationRoundTrip testMethod=test_round_trip>]>
  File "/Users/mattia/miniconda3/envs/general_ml/lib/python3.11/unittest/suite.py", line 84, in __call__
    return self.run(*args, **kwds)
           â”‚    â”‚    â”‚       â”” {}
           â”‚    â”‚    â”” (<unittest.runner.TextTestResult run=1 errors=0 failures=0>,)
           â”‚    â”” <function TestSuite.run at 0x102b12ac0>
           â”” <unittest.suite.TestSuite tests=[<tests.test_tokenization_round_trip.TestTokenizationRoundTrip testMethod=test_round_trip>]>
  File "/Users/mattia/miniconda3/envs/general_ml/lib/python3.11/unittest/suite.py", line 122, in run
    test(result)
    â”‚    â”” <unittest.runner.TextTestResult run=1 errors=0 failures=0>
    â”” <tests.test_tokenization_round_trip.TestTokenizationRoundTrip testMethod=test_round_trip>
  File "/Users/mattia/miniconda3/envs/general_ml/lib/python3.11/unittest/case.py", line 678, in __call__
    return self.run(*args, **kwds)
           â”‚    â”‚    â”‚       â”” {}
           â”‚    â”‚    â”” (<unittest.runner.TextTestResult run=1 errors=0 failures=0>,)
           â”‚    â”” <function TestCase.run at 0x102b0b420>
           â”” <tests.test_tokenization_round_trip.TestTokenizationRoundTrip testMethod=test_round_trip>
  File "/Users/mattia/miniconda3/envs/general_ml/lib/python3.11/unittest/case.py", line 623, in run
    self._callTestMethod(testMethod)
    â”‚    â”‚               â”” <bound method TestTokenizationRoundTrip.test_round_trip of <tests.test_tokenization_round_trip.TestTokenizationRoundTrip test...
    â”‚    â”” <function TestCase._callTestMethod at 0x102b0b240>
    â”” <tests.test_tokenization_round_trip.TestTokenizationRoundTrip testMethod=test_round_trip>
  File "/Users/mattia/miniconda3/envs/general_ml/lib/python3.11/unittest/case.py", line 579, in _callTestMethod
    if method() is not None:
       â”” <bound method TestTokenizationRoundTrip.test_round_trip of <tests.test_tokenization_round_trip.TestTokenizationRoundTrip test...

  File "/Users/mattia/Desktop/pleias/tok_library/tests/test_tokenization_round_trip.py", line 98, in test_round_trip
    preprocess_data_main(USER_CONFIG['config_file_path'])
    â”‚                    â”” {'config_file_path': '/Users/mattia/Desktop/pleias/tok_library/tests/test_config.yml', 'log_file_path': 'tests/test_log.log',...
    â”” <function preprocess_data_main at 0x12d7ea840>

  File "/Users/mattia/Desktop/pleias/tok_library/src/tok_library/preprocess_data.py", line 144, in preprocess_data_main
    preprocess_executor.run()
    â”‚                   â”” <function LocalPipelineExecutor.run at 0x12d807c40>
    â”” <datatrove.executor.local.LocalPipelineExecutor object at 0x13d4cfc90>

  File "/Users/mattia/miniconda3/envs/general_ml/lib/python3.11/site-packages/datatrove/executor/local.py", line 127, in run
    stats.append(self._launch_run_for_rank(rank, ranks_q))
    â”‚     â”‚      â”‚    â”‚                    â”‚     â”” <AutoProxy[Queue] object, typeid 'Queue' at 0x13c86bc10>
    â”‚     â”‚      â”‚    â”‚                    â”” 0
    â”‚     â”‚      â”‚    â”” <function LocalPipelineExecutor._launch_run_for_rank at 0x12d8074c0>
    â”‚     â”‚      â”” <datatrove.executor.local.LocalPipelineExecutor object at 0x13d4cfc90>
    â”‚     â”” <method 'append' of 'list' objects>
    â”” []
  File "/Users/mattia/miniconda3/envs/general_ml/lib/python3.11/site-packages/datatrove/executor/local.py", line 76, in _launch_run_for_rank
    return self._run_for_rank(rank, local_rank)
           â”‚    â”‚             â”‚     â”” 0
           â”‚    â”‚             â”” 0
           â”‚    â”” <function PipelineExecutor._run_for_rank at 0x12d807740>
           â”” <datatrove.executor.local.LocalPipelineExecutor object at 0x13d4cfc90>
> File "/Users/mattia/miniconda3/envs/general_ml/lib/python3.11/site-packages/datatrove/executor/base.py", line 90, in _run_for_rank
    pipelined_data = pipeline_step(pipelined_data, rank, self.world_size)
                     â”‚             â”‚               â”‚     â”‚    â”” <property object at 0x12d6930b0>
                     â”‚             â”‚               â”‚     â”” <datatrove.executor.local.LocalPipelineExecutor object at 0x13d4cfc90>
                     â”‚             â”‚               â”” 0
                     â”‚             â”” <generator object BaseDiskReader.run at 0x13d776240>
                     â”” ğŸ”¢ - TOKENIZER: âœï¸ Writer
  File "/Users/mattia/miniconda3/envs/general_ml/lib/python3.11/site-packages/datatrove/pipeline/base.py", line 119, in __call__
    return self.run(data, rank, world_size)
           â”‚    â”‚   â”‚     â”‚     â”” 1
           â”‚    â”‚   â”‚     â”” 0
           â”‚    â”‚   â”” <generator object BaseDiskReader.run at 0x13d776240>
           â”‚    â”” <function DocumentTokenizer.run at 0x119e9cae0>
           â”” ğŸ”¢ - TOKENIZER: âœï¸ Writer
  File "/Users/mattia/miniconda3/envs/general_ml/lib/python3.11/site-packages/datatrove/pipeline/tokens/tokenizer.py", line 390, in run
    outputfile: TokenizedFile = self.write_unshuffled(data, unshuf_filename)
                                â”‚    â”‚                â”‚     â”” '00000_unshuffled.ds'
                                â”‚    â”‚                â”” <generator object BaseDiskReader.run at 0x13d776240>
                                â”‚    â”” <function DocumentTokenizer.write_unshuffled at 0x119e9ca40>
                                â”” ğŸ”¢ - TOKENIZER: âœï¸ Writer
  File "/Users/mattia/miniconda3/envs/general_ml/lib/python3.11/site-packages/datatrove/pipeline/tokens/tokenizer.py", line 359, in write_unshuffled
    for batch in batched(data, self.batch_size):
                 â”‚       â”‚     â”‚    â”” 10
                 â”‚       â”‚     â”” ğŸ”¢ - TOKENIZER: âœï¸ Writer
                 â”‚       â”” <generator object BaseDiskReader.run at 0x13d776240>
                 â”” <function batched at 0x119e5cb80>
  File "/Users/mattia/miniconda3/envs/general_ml/lib/python3.11/site-packages/datatrove/utils/batching.py", line 20, in batched
    while batch := list(itertools.islice(it, n)):
                        â”‚         â”‚      â”‚   â”” 10
                        â”‚         â”‚      â”” <generator object BaseDiskReader.run at 0x13d776240>
                        â”‚         â”” <class 'itertools.islice'>
                        â”” <module 'itertools' (built-in)>
  File "/Users/mattia/miniconda3/envs/general_ml/lib/python3.11/site-packages/datatrove/pipeline/readers/base.py", line 227, in run
    raise RuntimeError(f"No files found on {self.data_folder.path}!")

RuntimeError: No files found on /Users/mattia/Desktop/pleias/tok_library/data/ItalianPD_1.parquet!
